qt(p = 0.05, df = 34)
t.test(Pr1,Pr2)
qt(p = 0.05, df = 34)
qt(p = 0.05 / 2, df = 34)
mean1
mean2
t.test(zoo_data)
qt(p = 0.95 + 0.05/2, df = 34, lower.tail = TRUE)
qt(p = 0.95, df = 34, lower.tail = TRUE)
qt(p = 0.95, df = 34, lower.tail = TRUE)
qt(p = 0.05, df = 34, lower.tail = TRUE)
qt(p = 0.05 / 2, df = 34, lower.tail = TRUE)
dt(p = 0.05, df = 34, lower.tail = TRUE)
pt(p = 0.05, df = 34, lower.tail = TRUE)
pt(q = 0.05, df = 34, lower.tail = TRUE)
dt(df = 34)
tt <- qt(df = Inf)
qt(p = 0.05, df = Inf)
qt(p = 0.0025, df = Inf)
qt(p = 0.000025, df = Inf)
qt(p = 0.000015, df = Inf)
qt(p = 0.0025, df = Inf)
tc
ab(tc)
abs(tc)
if (abs(tc) == tt) {
print('NO SE CORRIGE')
} else {
print('SE CORRIGE')
}
tt = 1.960
tc <- (mean1 - mean2) / sd
tt = 1.960
if (abs(tc) == tt) {
print('NO SE CORRIGE')
} else {
print('SE CORRIGE')
}
sd2_2
sd1_2
if (abs(tc) == tt) {
print('NO SE CORRIGE')
} else {
print('SE CORRIGE')
if (sd2_2 > sd1_2) {
print('Se calcula FC')
} else {
print('No se caulula FC')
}
}
Fc = sd2_2 / sd1_2
Fc
if (abs(tc) == tt) {
print('NO SE CORRIGE')
} else {
print('SE CORRIGE')
if (sd2_2 > sd1_2) {
print('Se calcula FC')
Fc = sd2_2 / sd1_2
} else {
print('No se caulula FC')
}
}
rm(Fc)
if (abs(tc) == tt) {
print('NO SE CORRIGE')
} else {
print('SE CORRIGE')
if (sd2_2 > sd1_2) {
print('Se calcula FC')
Fc = sd2_2 / sd1_2
} else {
print('No se caulula FC')
}
}
n2
n1
qt(0.95, df = 21)
pt(0.95, df = 21)
dt(0.95, df = 21)
var.test(x = Pr1, y = Pr2)
var.test(x = Pr2, y = Pr1)
sd2
mean2
Xt <- ((xt - mean1) / sd1 ) * sd2 + mean2
Xt <- ((xt - mean1) / sd1 ) * sd2 ~ mean2
Xt
Xt <- formula(((xt - mean1) / sd1 ) * sd2 ~ mean2)
Xt
tc
t.test(Pr1,Pr2)
tc
t.test(Pr2,Pr1)
qt(0.05,df = 34)
qt(0.025,df = 34)
t.test(Pr2,Pr1)
tc
t.test(Pr1, Pr2)
tc
qt(0.025, df = 34)
qt(0.05 / 2, df = 34)
Xt <- expression(((xt - mean1) / sd1 ) * sd2 ~ mean2)
Xt
xt = 1
Xt <- expression(((xt - mean1) / sd1 ) * sd2 ~ mean2)
Xt
Corr <- ((Pr1 - mean1) / sd1 ) * sd2 + mean2
Corr
Pr1
New_Vol <- cbind(Corr, Pr2)
New_Vol
New_Vol <- rbind(Corr, Pr2)
New_Vol
Vol_dataN <- data.frame(New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_data[,2]))
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') + theme_bw()
Vol2
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') + theme_bw()
Vol2
Vol_dataN
Vol_dataN <- data.frame(New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,2]))
Vol_dataN
New_Vol <- rbind(Corr, Pr2)
New_Vol
Vol_dataN <- data.frame(New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(New_Vol[,2]))
Vol_dataN <- data.frame(New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(New_Vol[,2]))
data.frame(New_Vol)
New_Vol[,2]
New_Vol[,1]
Vol_dataN <- data.frame(New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_data[,1]))
Vol_dataN
Vol_dataN[,2]
Vol_dataN[,2]
Vol_dataN[,1]
Vol_dataN <- data.frame(New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1]))
Vol_dataN
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') + theme_bw()
Vol2
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') + theme_bw()
VolAcum <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = VolAcum)) +
geom_line(col = 'blue') +
labs(title = 'Grafico de Volumenes acumulados',
x = 'Años', y = 'Volumen acumulado mm3') + theme_bw()
plot_vol <- ggarrange(Vol, VolAcum)
plot_vol <- ggarrange(Vol2, VolAcum2)
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
VolAcum2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = VolAcum)) +
geom_line(col = 'blue') +
labs(title = 'Grafico de Volumenes acumulados Corregidos',
x = 'Años', y = 'Volumen acumulado mm3') +
theme_bw()
plot_vol <- ggarrange(Vol2, VolAcum2)
ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3))
Vol_dataN
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = , y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
Vol2
rownames(New_Vol)
class(New_Vol)
index(New_Vol)
Vol_dataN <- data.frame(Date = index(New_Vol), New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1]))
Vol_dataN
index(Vol_dataN)
Vol_dataN
New_Vol <- rbind(Corr, Pr2)
Vol_dataN <- data.frame(New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1]))
Vol_dataN
index(Vol_dataN)
Vol_dataN <- data.frame(New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1]))
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = index(New_Vol), y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
Vol2
index(New_Vol)
Vol_dataN <- data.frame(Date = index(New_Vol), New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1]))
Vol_dataN
VolAcum2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = VolAcum)) +
geom_line(col = 'blue') +
labs(title = 'Grafico de Volumenes acumulados Corregidos',
x = 'Años', y = 'Volumen acumulado mm3') +
theme_bw()
VolAcum2
Vol_dataN <- data.frame(Date = index(New_Vol), New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1]))
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
Vol2
ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3))
Vol_dataN
Vol_data
Vol_dataN <- data.frame(Date = index(New_Vol), New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1])) %>%  tibble()
Vol_dataN
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
VolAcum2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = VolAcum)) +
geom_line(col = 'blue') +
labs(title = 'Grafico de Volumenes acumulados Corregidos',
x = 'Años', y = 'Volumen acumulado mm3') +
theme_bw()
plot_vol <- ggarrange(Vol2, VolAcum2)
plot_vol
Vol_dataN <- data.frame(Date = index(New_Vol), New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1])) %>%  data.frame()
Vol_dataN <- data.frame(Date = index(New_Vol), New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1]))
Vol_dataN <- data.frame(Date = index(New_Vol), New_Vol) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1]))
New_Vol <- rbind(Corr, Pr2)
New_Vol
New_Vol
Vol_dataN <- data.frame(Date = index(New_Vol), numeric(New_Vol)) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1]))
numeric(New_Vol)
New_Vol$Vol_mm3
as.numeric(New_Vol$Vol_mm3)
as.numeric(New_Vol$Vol_mm3)
index(New_Vol)
Vol_dataN <- data.frame(Date = index(New_Vol), Vol_mm3 = as.numeric(New_Vol$Vol_mm3)) %>%
dplyr::mutate(VolAcum = cumsum(Vol_dataN[,1]))
data.frame(Date = index(New_Vol), Vol_mm3 = as.numeric(New_Vol$Vol_mm3))
New_Vol[,1]
Vol_dataN <- data.frame(Date = index(New_Vol), Vol_mm3 = as.numeric(New_Vol$Vol_mm3)) %>%
dplyr::mutate(VolAcum = cumsum(New_Vol))
Vol_dataN
rm(Vol_dataN)
New_Vol <- rbind(Corr, Pr2)
Vol_dataN <- data.frame(Date = index(New_Vol), Vol_mm3 = as.numeric(New_Vol$Vol_mm3)) %>%
dplyr::mutate(VolAcum = cumsum(New_Vol))
Vol_dataN
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
Vol2
Vol_dataN
Date
Vol_mm3
ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3))
class(Vol_dataN)
class(Vol_dataN$Date)
class(Vol_dataN$Vol_mm3)
class(Vol_dataN$VolAcum)
Vol_dataN <- data.frame(Date = index(New_Vol), Vol_mm3 = as.numeric(New_Vol$Vol_mm3)) %>%
dplyr::mutate(VolAcum = as.numeric(cumsum(New_Vol)))
Vol_dataN
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
Vol2
class(Vol_dataN$Vol_mm3)
class(Vol_dataN$VolAcum)
class(Vol_dataN$Date)
class(Vol_data$Date)
Vol_dataN <- data.frame(Date = as.integer(index(New_Vol)), Vol_mm3 = as.numeric(New_Vol$Vol_mm3)) %>%
dplyr::mutate(VolAcum = as.numeric(cumsum(New_Vol)))
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
Vol2
class(New_Vol)
Vol_dataN <- data.frame(Date = as.integer(index(New_Vol)),
Vol_mm3 = as.numeric(New_Vol$Vol_mm3)) %>%
dplyr::mutate(VolAcum = as.numeric(cumsum(New_Vol)))
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
VolAcum2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = VolAcum)) +
geom_line(col = 'blue') +
labs(title = 'Grafico de Volumenes acumulados Corregidos',
x = 'Años', y = 'Volumen acumulado mm3') +
theme_bw()
plot_vol <- ggarrange(Vol2, VolAcum2)
plot_vol
plot_vol3 <- ggarrange(plot_vol1, plot_vol2)
plot_vol3 <- ggarrange(plot_vol, plot_vol2)
plot_vol2 <- ggarrange(Vol2, VolAcum2)
plot_vol2
plot_vol3 <- ggarrange(plot_vol, plot_vol2)
plot_vol3
rm(list = ls())
dev.off()
library(zoo)
library(tidyverse)
# library(ggarrange)
library(ggpubr)
Vol_data <- read.csv(file = 'Data.csv', header = T)
head(Vol_data)
# transformed to zoo format
zoo_data <- zoo(x = Vol_data[-1], order.by = format(Vol_data[,1], format = '%Y'))
# transformed to data frame format
Vol_data2 <- data.frame(Vol_data) %>%
dplyr::mutate(VolAcum = cumsum(Vol_data[,2]))
Vol <- ggplot(data = Vol_data2, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes',
x = 'Años', y = 'Volumen mm3') + theme_bw()
VolAcum <- ggplot(data = Vol_data2, mapping = aes(x = Date, y = VolAcum)) +
geom_line(col = 'blue') +
labs(title = 'Grafico de Volumenes acumulados',
x = 'Años', y = 'Volumen acumulado mm3') + theme_bw()
plot_vol <- ggarrange(Vol, VolAcum)
plot_vol
ggsave(filename = 'Volumenes', plot = plot_vol, device = 'png',
width = 2400, height = 1000, units = "px")
# For period 1 1964 - 1985
Pr1 <- window(x = zoo_data,
start = 1964,
end = 1985)
n1 <- length(Pr1)
mean1 <- mean(Pr1)
sd1 <- sd(Pr1)
sd1_2 <- sd1^2
# For period 2 1986 - 1999
Pr2 <- window(x = zoo_data,
start = 1986,
end = 1999)
n2 <- length(Pr2)
mean2 <- mean(Pr2)
sd2 <- sd(Pr2)
sd2_2 <- sd2^2
sp <- (((n1-1)*sd1_2 + (n2-1)*sd2_2)/(n1+n2-2))^0.5
sp
sd <- sp*(1/n1 + 1/n2)^0.5
sd
t.test(zoo_data)
tc <- (mean1 - mean2) / sd
tt = 1.960 # Table A.5
if (abs(tc) == tt) {
print('NO SE CORRIGE')
} else {
print('SE CORRIGE')
if (sd2_2 > sd1_2) {
print('Se calcula FC')
Fc = sd2_2 / sd1_2
# var.test(x = Pr2, y = Pr1)
} else {
print('No se caulula FC')
}
}
Corr <- ((Pr1 - mean1) / sd1 ) * sd2 + mean2
New_Vol <- rbind(Corr, Pr2)
class(New_Vol)
Vol_dataN <- data.frame(Date = as.integer(index(New_Vol)),
Vol_mm3 = as.numeric(New_Vol$Vol_mm3)) %>%
dplyr::mutate(VolAcum = as.numeric(cumsum(New_Vol)))
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
VolAcum2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = VolAcum)) +
geom_line(col = 'blue') +
labs(title = 'Grafico de Volumenes acumulados Corregidos',
x = 'Años', y = 'Volumen acumulado mm3') +
theme_bw()
plot_vol2 <- ggarrange(Vol2, VolAcum2)
plot_vol2
plot_vol3 <- ggarrange(plot_vol, plot_vol2)
plot_vol3
plot_vol3 <- ggarrange(plot_vol, plot_vol2, nrow = 2)
plot_vol3
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green2') +
labs(title = 'Grafico de Volumenes Corregido',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
VolAcum2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = VolAcum)) +
geom_line(col = 'red4') +
labs(title = 'Grafico de Volumenes acumulados Corregidos',
x = 'Años', y = 'Volumen acumulado mm3') +
theme_bw()
plot_vol2 <- ggarrange(Vol2, VolAcum2)
plot_vol2
plot_vol3 <- ggarrange(plot_vol, plot_vol2, nrow = 2)
plot_vol3
ggsave(filename = 'Volumenes_Corregidos', plot = plot_vol3, device = 'png',
width = 4000, height = 1000, units = "px")
ggsave(filename = 'Volumenes_Corregidos', plot = plot_vol3, device = 'png',
width = 3000, height = 1500, units = "px")
install.packages('zoo')
install.packages('tidyverse')
# install.packages('ggarrange')
install.packages('ggpubr')
library(zoo)
library(tidyverse)
# library(ggarrange)
library(ggpubr)
Vol_data <- read.csv(file = 'Data.csv', header = T)
head(Vol_data)
# transformed to zoo format
zoo_data <- zoo(x = Vol_data[-1], order.by = format(Vol_data[,1], format = '%Y'))
# transformed to data frame format
Vol_data2 <- data.frame(Vol_data) %>%
dplyr::mutate(VolAcum = cumsum(Vol_data[,2]))
Vol <- ggplot(data = Vol_data2, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green4') +
labs(title = 'Grafico de Volumenes',
x = 'Años', y = 'Volumen mm3') + theme_bw()
VolAcum <- ggplot(data = Vol_data2, mapping = aes(x = Date, y = VolAcum)) +
geom_line(col = 'blue') +
labs(title = 'Grafico de Volumenes acumulados',
x = 'Años', y = 'Volumen acumulado mm3') + theme_bw()
plot_vol <- ggarrange(Vol, VolAcum)
plot_vol
ggsave(filename = 'Volumenes', plot = plot_vol, device = 'png',
width = 2400, height = 1000, units = "px")
# For period 1 1964 - 1985
Pr1 <- window(x = zoo_data,
start = 1964,
end = 1985)
n1 <- length(Pr1)
n1 <- length(Pr1)
mean1 <- mean(Pr1)
sd1 <- sd(Pr1)
sd1_2 <- sd1^2
# For period 2 1986 - 1999
Pr2 <- window(x = zoo_data,
start = 1986,
end = 1999)
n2 <- length(Pr2)
mean2 <- mean(Pr2)
sd2 <- sd(Pr2)
sd2_2 <- sd2^2
sp <- (((n1-1)*sd1_2 + (n2-1)*sd2_2)/(n1+n2-2))^0.5
sp
sd <- sp*(1/n1 + 1/n2)^0.5
sd
t.test(zoo_data)
tc <- (mean1 - mean2) / sd
tt = 1.960 # Table A.5
if (abs(tc) == tt) {
print('NO SE CORRIGE')
} else {
print('SE CORRIGE')
if (sd2_2 > sd1_2) {
print('Se calcula FC')
Fc = sd2_2 / sd1_2
# var.test(x = Pr2, y = Pr1)
} else {
print('No se caulula FC')
}
}
Corr <- ((Pr1 - mean1) / sd1 ) * sd2 + mean2
New_Vol <- rbind(Corr, Pr2)
class(New_Vol)
Vol_dataN <- data.frame(Date = as.integer(index(New_Vol)),
Vol_mm3 = as.numeric(New_Vol$Vol_mm3)) %>%
dplyr::mutate(VolAcum = as.numeric(cumsum(New_Vol)))
Vol2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = Vol_mm3)) +
geom_line(col = 'green2') +
labs(title = 'Grafico de Volumenes Corregidos',
x = 'Años', y = 'Volumen mm3') +
theme_bw()
VolAcum2 <- ggplot(data = Vol_dataN, mapping = aes(x = Date, y = VolAcum)) +
geom_line(col = 'red4') +
labs(title = 'Grafico de Volumenes acumulados Corregidos',
x = 'Años', y = 'Volumen acumulado mm3') +
theme_bw()
plot_vol2 <- ggarrange(Vol2, VolAcum2)
plot_vol2
plot_vol3 <- ggarrange(plot_vol, plot_vol2, nrow = 2)
plot_vol3
ggsave(filename = 'Volumenes_Corregidos', plot = plot_vol3, device = 'png',
width = 3000, height = 1500, units = "px")
New_Vol
write.csv(x = New_Vol, file = 'New_vol_c.csv')
write.zoo(x = New_Vol, file = 'New_vol_c.csv')
write.zoo(x = New_Vol, file = 'New_vol_c.csv', sep = ';')
